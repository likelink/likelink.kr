(function(){window.ll={};jQuery.fn.center=function(){this.css("position","absolute");this.css("top",(($(window).height()-this.outerHeight())/2)+$(window).scrollTop()+"px");this.css("left",(($(window).width()-this.outerWidth())/2)+$(window).scrollLeft()+"px");return this};ll.init=function(){$("a[href=#]").click(function(a){a.preventDefault()});ll.make_bootstrap_navbar_onoff();ll.init_bootstrap_popovers();$("#listing-contents .post-box").click(function(b){var a;a=$("#listing-contents .post-box").index($(this));if(typeof _gaq!=="undefined"&&_gaq!==null){_gaq.push(["_trackEvent","test","testClick","idx="+a])}if(!b.ctrlKey&&!b.metaKey){window.location.href=$(this).find("h2.title a")[0].href}})};ll.init_bootstrap_popovers=function(){$(".bootstrap-popovers").popover({trigger:"hover",html:true})};ll.make_bootstrap_navbar_onoff=function(){$(".btn-navbar").click(function(){$(".nav-collapse").toggleClass("show-mobile-nav");return false})};ll.LinkCreateForm={init:function(){$("#suggest-title").click(function(b){var a;b.preventDefault();a=$("#post-create-form *[name=url]").val();$("#suggest-title").hide();ll.Util.ajax({type:"GET",url:"/api/get_title?url="+encodeURIComponent(a),success:function(c){$("#post-create-form textarea[name=title]").html(c.title);$("#suggest-title").show()},resultError:function(c){$("#suggest-title").show()}})});$(".comm-radio-button").click(function(b){var a;b.preventDefault();a=$(this).text();if(a==="없음"){a=""}$("#post-create-form input[name=t_name]").val(a)})}};ll.Posts={init:function(){$(".post-box").each(function(a,b){new ll.Post(b)})}};ll.Post=function(a){var b;this.element=$(a);b=this.element.attr("data-ll");if(b){this.data=$.parseJSON(this.element.attr("data-ll"));this.id=this.data.id;this.pid=this.data.pid;this.url=("r"===this.pid?"/p/"+this.id:"/p/"+this.pid+"/comment/"+this.id);this.initEvent()}};ll.Post.prototype={id:null,element:null,initEvent:function(){if(is_mobile!=="1"){$("#voteup-post-"+this.id).tooltip({tipClass:"tooltip-vote",effect:"slide",opacity:0.7,offset:[20,42]});$("#votedn-post-"+this.id).tooltip({tipClass:"tooltip-vote",effect:"slide",opacity:0.7,offset:[32,42]});$("#follow-link-"+this.id).tooltip({tipClass:"tooltip-vote",effect:"slide",opacity:0.7,offset:[32,48]})}$("#voteup-post-"+this.id).unbind("click");$("#votedn-post-"+this.id).unbind("click");$("#voteup-postinfo-"+this.id).unbind("click");$("#follow-link-"+this.id).unbind("click");$("#voteup-post-"+this.id).bind("click",{id:this.id,el:this.element,url:this.url},this.handlers.voteUp);$("#votedn-post-"+this.id).bind("click",{id:this.id,el:this.element,url:this.url},this.handlers.voteDown);$("#voteup-postinfo-"+this.id).bind("click",{id:this.id,el:this.element,url:this.url},this.handlers.voteUp);$("#follow-link-"+this.id).bind("click",{id:this.id,el:this.element,url:this.url},this.handlers.followLinkToggle);this.element.find("a.create-sub-comment").unbind("click");this.element.find("a.create-sub-comment").bind("click",{id:this.id,el:this.element},this.handlers.showCreateSubComment)},handlers:{voteUp:function(b){var a;b.preventDefault();a=$("#vote-score-"+b.data.id);a.html(parseInt(a.text(),10)+1);ll.Util.ajax({type:"POST",url:b.data.url+"/voteup",resultError:function(c){a.html(parseInt(a.text(),10)-1)}});b.stopPropagation()},voteDown:function(b){var a;b.preventDefault();a=$("#vote-score-"+b.data.id);a.html(parseInt(a.text(),10)-1);ll.Util.ajax({type:"POST",url:b.data.url+"/votedn",resultError:function(c){a.html(parseInt(a.text(),10)+1)}});b.stopPropagation()},followLinkToggle:function(b){var a;b.preventDefault();a=$("#follow-link-"+b.data.id);a.toggleClass("follow-link-on");ll.Util.ajax({type:"POST",url:b.data.url+"/follow_toggle",success:function(c){if(c.onoff==="off"){a.removeClass("follow-link-on")}},resultError:function(c){a.removeClass("follow-link-on")}})},showCreateSubComment:function(a){a.preventDefault();$("#sub-comment-form-"+a.data.id).toggle()}}};ll.Util={ajax:function(a){if(!a){a={}}$.ajax({type:(a.type?a.type:"GET"),url:a.url,data:(a.data?a.data:""),dataType:"json",statusCode:{404:function(){}},success:function(b){if(b.result===1){if(typeof a.success==="function"){a.success(b)}}else{if(b.errMsg){if(typeof a.resultError==="function"){a.resultError(b)}$.fancybox({content:b.errMsg,padding:20,scrolling:"no"})}else{alert("에러입니다.")}}},error:function(b){}})},is_signin:function(){return""!==account_id},assert_signin_or_redirect:function(){if(false===this.is_signin()){window.location.href="/account/sign_in?continue="+document.URL}},assert_signin_or_alert:function(){if(false===this.is_signin()){ll.Util.alert_fancy("비회원은 <b>익명</b>으로 표시됩니다.")}},show_notice_if_logout:function(a){if(false===this.is_signin()){$("#"+a).html('비회원은 <b>익명</b>으로 표시됩니다. <a href="/account/sign_in?continue='+location.href+'">로그인</a>, <a href="/account/sign_up?continue='+location.href+'">회원가입</a>');$("#"+a).fadeIn(300)}},get_title:function(a){$.get(a,function(b){alert("This is the url: "+a);if((/<title>(.*?)<\/title>/m.exec(b))!=null){alert("This would be the title: "+/<title>(.*?)<\/title>/m.exec(b)[1])}else{alert("title was null")}})},submit_on_click:function(a){document.form_id.submit()},alert_fancy:function(a){$.fancybox({content:a,padding:20,scrolling:"no"})},show_error_layer:function(c,b){var a;$(".error-layer").remove();a=$('<div class="error-notification supernovabg"><h2>'+b+'</h2><span class="error-close">(클릭하면 이 박스는 없어집니다.)</span></div>');$(c).append(a)}};return}).call(this);