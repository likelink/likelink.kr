var dbg=function(a){if(typeof console!=="undefined"){console.log("Readability: "+a)}};var readability={version:"0.5.1",emailSrc:"http://lab.arc90.com/experiments/readability/email.php",kindleSrc:"http://lab.arc90.com/experiments/readability/kindle.php",iframeLoads:0,frameHack:false,bodyCache:null,regexps:{unlikelyCandidatesRe:/combx|comment|disqus|foot|header|menu|meta|nav|rss|shoutbox|sidebar|sponsor/i,okMaybeItsACandidateRe:/and|article|body|column|main/i,positiveRe:/article|body|content|entry|hentry|page|pagination|post|text/i,negativeRe:/combx|comment|contact|foot|footer|footnote|link|media|meta|promo|related|scroll|shoutbox|sponsor|tags|widget/i,divToPElementsRe:/<(a|blockquote|dl|div|img|ol|p|pre|table|ul)/i,replaceBrsRe:/(<br[^>]*>[ \n\r\t]*){2,}/gi,replaceFontsRe:/<(\/?)font[^>]*>/gi,trimRe:/^\s+|\s+$/g,normalizeRe:/\s{2,}/g,killBreaksRe:/(<br\s*\/?>(\s|&nbsp;?)*){1,}/g,videoRe:/http:\/\/(www\.)?(youtube|vimeo)\.com/i},init:function(h){h=(typeof h=="undefined")?false:h;if(document.body&&!readability.bodyCache){readability.bodyCache=document.body.innerHTML}readability.prepDocument();var b=document.createElement("DIV");var d=document.createElement("DIV");var c=readability.getArticleTools();var e=readability.getArticleTitle();var a=readability.grabArticle(h);var g=readability.getArticleFooter();if(readability.getInnerText(a,false)==""){if(!h){document.body.innerHTML=readability.bodyCache;return readability.init(true)}else{a.innerHTML="<p>죄송합니다. 처리 하지 못했습니다. <a href='#' onclick='return window.location.reload()' title='원래 페이지로 되돌리기' id='reload-page'>원래 페이지로 되돌리기</a></p>"}}b.id="readOverlay";d.id="readInner";document.body.className=readStyle;b.className=readStyle;d.className=readMargin+" "+readSize;d.appendChild(e);d.appendChild(a);b.appendChild(c);b.appendChild(d);document.body.innerHTML="";document.body.insertBefore(b,document.body.firstChild);if(readability.frameHack){var f=document.getElementById("readOverlay");f.style.height="100%";f.style.overflow="auto"}},getArticleTools:function(){var a=document.createElement("DIV");a.id="readTools";a.innerHTML="			<a href='#' onclick='return window.location.reload()' title='원래 페이지로 되돌리기' id='reload-page'>원래 페이지로 되돌리기</a>		";return a},getArticleTitle:function(){var a=document.createElement("H1");a.innerHTML=document.title;return a},getArticleFooter:function(){var a=document.createElement("DIV");a.id="readFooter";a.innerHTML="			<a href='http://lab.arc90.com/experiments/readability'><img src='http://lab.arc90.com/experiments/readability/images/footer-readability.png'></a>			<a href='http://www.arc90.com'><img src='http://lab.arc90.com/experiments/readability/images/footer-arc90.png'></a>			<a href='http://www.twitter.com/arc90' class='footer-twitterLink'>Follow us on Twitter &raquo;</a>	                <div class='footer-right' >	                        <span class='version'>Readability version "+readability.version+"</span>					</div>		";return a},prepDocument:function(){if(document.body===null){body=document.createElement("body");try{document.body=body}catch(q){document.documentElement.appendChild(body)}}var r=document.getElementsByTagName("frame");if(r.length>0){var g=null;var t=0;for(var f=0;f<r.length;f++){var n=r[f].offsetWidth+r[f].offsetHeight;var s=false;try{r[f].contentWindow.document.body;s=true}catch(q){}if(s&&n>t){g=r[f];t=n}}if(g){var b=document.createElement("body");b.innerHTML=g.contentWindow.document.body.innerHTML;b.style.overflow="scroll";document.body=b;var m=document.getElementsByTagName("frameset")[0];if(m){m.parentNode.removeChild(m)}readability.frameHack=true}}if(readStyle=="style-classy"){var a=document.createElement("script");a.type="text/javascript";a.src="http://use.typekit.com/sxt6vzy.js";document.body.appendChild(a);var c=document.createElement("script");c.type="text/javascript";var p=document.createTextNode("try{Typekit.load();}catch(e){}");c.appendChild(p);document.body.appendChild(c)}var l=document.getElementsByTagName("script");for(i=l.length-1;i>=0;i--){if(typeof(l[i].src)=="undefined"||l[i].src.indexOf("readability")==-1){l[i].parentNode.removeChild(l[i])}}for(var h=0;h<document.styleSheets.length;h++){if(document.styleSheets[h].href!=null&&document.styleSheets[h].href.lastIndexOf("readability")==-1){document.styleSheets[h].disabled=true}}var d=document.getElementsByTagName("style");for(var o=0;o<d.length;o++){if(navigator.appName!="Microsoft Internet Explorer"){d[o].textContent=""}}document.body.innerHTML=document.body.innerHTML.replace(readability.regexps.replaceBrsRe,"</p><p>").replace(readability.regexps.replaceFontsRe,"<$1span>")},prepArticle:function(b){readability.cleanStyles(b);readability.killBreaks(b);readability.clean(b,"form");readability.clean(b,"object");readability.clean(b,"h1");if(b.getElementsByTagName("h2").length==1){readability.clean(b,"h2")}readability.clean(b,"iframe");readability.cleanHeaders(b);readability.cleanConditionally(b,"table");readability.cleanConditionally(b,"ul");readability.cleanConditionally(b,"div");var f=b.getElementsByTagName("p");for(i=f.length-1;i>=0;i--){var c=f[i].getElementsByTagName("img").length;var d=f[i].getElementsByTagName("embed").length;var a=f[i].getElementsByTagName("object").length;if(c==0&&d==0&&a==0&&readability.getInnerText(f[i],false)==""){f[i].parentNode.removeChild(f[i])}}try{b.innerHTML=b.innerHTML.replace(/<br[^>]*>\s*<p/gi,"<p")}catch(g){dbg("Cleaning innerHTML of breaks failed. This is an IE strict-block-elements bug. Ignoring.")}},initializeNode:function(a){a.readability={contentScore:0};switch(a.tagName){case"DIV":a.readability.contentScore+=5;break;case"PRE":case"TD":case"BLOCKQUOTE":a.readability.contentScore+=3;break;case"ADDRESS":case"OL":case"UL":case"DL":case"DD":case"DT":case"LI":case"FORM":a.readability.contentScore-=3;break;case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"TH":a.readability.contentScore-=5;break}a.readability.contentScore+=readability.getClassWeight(a)},grabArticle:function(v){for(var x=0;(node=document.getElementsByTagName("*")[x]);x++){if(!v){var t=node.className+node.id;if(t.search(readability.regexps.unlikelyCandidatesRe)!==-1&&t.search(readability.regexps.okMaybeItsACandidateRe)==-1&&node.tagName!=="BODY"){dbg("Removing unlikely candidate - "+t);node.parentNode.removeChild(node);x--;continue}}if(node.tagName==="DIV"){if(node.innerHTML.search(readability.regexps.divToPElementsRe)===-1){dbg("Altering div to p");var a=document.createElement("p");try{a.innerHTML=node.innerHTML;node.parentNode.replaceChild(a,node);x--}catch(z){dbg("Could not alter div to p, probably an IE restriction, reverting back to div.")}}else{for(var w=0,n=node.childNodes.length;w<n;w++){var b=node.childNodes[w];if(b.nodeType==Node.TEXT_NODE){dbg("replacing text node with a p tag with the same content.");var q=document.createElement("p");q.innerHTML=b.nodeValue;q.style.display="inline";q.className="readability-styled";b.parentNode.replaceChild(q,b)}}}}}var A=document.getElementsByTagName("p");var d=[];for(var u=0;u<A.length;u++){var k=A[u].parentNode;var B=k.parentNode;var g=readability.getInnerText(A[u]);if(g.length<25){continue}if(typeof k.readability=="undefined"){readability.initializeNode(k);d.push(k)}if(typeof B.readability=="undefined"){readability.initializeNode(B);d.push(B)}var s=0;s++;s+=g.split(",").length;s+=Math.min(Math.floor(g.length/100),3);k.readability.contentScore+=s;B.readability.contentScore+=s/2}var m=null;for(var w=0,n=d.length;w<n;w++){d[w].readability.contentScore=d[w].readability.contentScore*(1-readability.getLinkDensity(d[w]));dbg("Candidate: "+d[w]+" ("+d[w].className+":"+d[w].id+") with score "+d[w].readability.contentScore);if(!m||d[w].readability.contentScore>m.readability.contentScore){m=d[w]}}if(m==null||m.tagName=="BODY"){m=document.createElement("DIV");m.innerHTML=document.body.innerHTML;document.body.innerHTML="";document.body.appendChild(m);readability.initializeNode(m)}var r=document.createElement("DIV");r.id="readability-content";var l=Math.max(10,m.readability.contentScore*0.2);var f=m.parentNode.childNodes;for(var w=0,n=f.length;w<n;w++){var c=f[w];var y=false;dbg("Looking at sibling node: "+c+" ("+c.className+":"+c.id+")"+((typeof c.readability!="undefined")?(" with score "+c.readability.contentScore):""));dbg("Sibling has score "+(c.readability?c.readability.contentScore:"Unknown"));if(c===m){y=true}if(typeof c.readability!="undefined"&&c.readability.contentScore>=l){y=true}if(c.nodeName=="P"){var o=readability.getLinkDensity(c);var h=readability.getInnerText(c);var C=h.length;if(C>80&&o<0.25){y=true}else{if(C<80&&o==0&&h.search(/\.( |$)/)!==-1){y=true}}}if(y){dbg("Appending node: "+c);r.appendChild(c);w--;n--}}readability.prepArticle(r);return r},getInnerText:function(c,a){var b="";a=(typeof a=="undefined")?true:a;if(navigator.appName=="Microsoft Internet Explorer"){b=c.innerText.replace(readability.regexps.trimRe,"")}else{b=c.textContent.replace(readability.regexps.trimRe,"")}if(a){return b.replace(readability.regexps.normalizeRe," ")}else{return b}},getCharCount:function(b,a){a=a||",";return readability.getInnerText(b).split(a).length},cleanStyles:function(a){a=a||document;var b=a.firstChild;if(!a){return}if(typeof a.removeAttribute=="function"&&a.className!="readability-styled"){a.removeAttribute("style")}while(b!=null){if(b.nodeType==1){if(b.className!="readability-styled"){b.removeAttribute("style")}readability.cleanStyles(b)}b=b.nextSibling}},getLinkDensity:function(g){var b=g.getElementsByTagName("a");var d=readability.getInnerText(g).length;var f=0;for(var c=0,a=b.length;c<a;c++){f+=readability.getInnerText(b[c]).length}return f/d},getClassWeight:function(b){var a=0;if(b.className!=""){if(b.className.search(readability.regexps.negativeRe)!==-1){a-=25}if(b.className.search(readability.regexps.positiveRe)!==-1){a+=25}}if(typeof(b.id)=="string"&&b.id!=""){if(b.id.search(readability.regexps.negativeRe)!==-1){a-=25}if(b.id.search(readability.regexps.positiveRe)!==-1){a+=25}}return a},killBreaks:function(a){try{a.innerHTML=a.innerHTML.replace(readability.regexps.killBreaksRe,"<br />")}catch(a){dbg("KillBreaks failed - this is an IE bug. Ignoring.")}},clean:function(c,a){var d=c.getElementsByTagName(a);var b=(a=="object"||a=="embed");for(var f=d.length-1;f>=0;f--){if(b&&d[f].innerHTML.search(readability.regexps.videoRe)!==-1){continue}d[f].parentNode.removeChild(d[f])}},cleanConditionally:function(m,t){var h=m.getElementsByTagName(t);var f=h.length;for(var j=f-1;j>=0;j--){var l=readability.getClassWeight(h[j]);dbg("Cleaning Conditionally "+h[j]+" ("+h[j].className+":"+h[j].id+")"+((typeof h[j].readability!="undefined")?(" with score "+h[j].readability.contentScore):""));if(l<0){h[j].parentNode.removeChild(h[j])}else{if(readability.getCharCount(h[j],",")<10){var d=h[j].getElementsByTagName("p").length;var k=h[j].getElementsByTagName("img").length;var s=h[j].getElementsByTagName("li").length-100;var q=h[j].getElementsByTagName("input").length;var r=0;var c=h[j].getElementsByTagName("embed");for(var g=0,o=c.length;g<o;g++){if(c[g].src.search(readability.regexps.videoRe)==-1){r++}}var n=readability.getLinkDensity(h[j]);var b=readability.getInnerText(h[j]).length;var a=false;if(k>d){a=true}else{if(s>d&&t!="ul"&&t!="ol"){a=true}else{if(q>Math.floor(d/3)){a=true}else{if(b<25&&(k==0||k>2)){a=true}else{if(l<25&&n>0.2){a=true}else{if(l>=25&&n>0.5){a=true}else{if((r==1&&b<75)||r>1){a=true}}}}}}}if(a){h[j].parentNode.removeChild(h[j])}}}}},cleanHeaders:function(c){for(var a=1;a<7;a++){var d=c.getElementsByTagName("h"+a);for(var b=d.length-1;b>=0;b--){if(readability.getClassWeight(d[b])<0||readability.getLinkDensity(d[b])>0.33){d[b].parentNode.removeChild(d[b])}}}},emailBox:function(){var a=document.getElementById("email-container");if(null!=a){return}var a=document.createElement("div");a.setAttribute("id","email-container");a.innerHTML='<iframe src="'+readability.emailSrc+"?pageUrl="+escape(window.location)+"&pageTitle="+escape(document.title)+'" scrolling="no" onload="readability.removeFrame()" style="width:500px; height: 490px; border: 0;"></iframe>';document.body.appendChild(a)},kindleBox:function(){var b=document.getElementById("kindle-container");if(null!=b){return}var b=document.createElement("div");b.setAttribute("id","kindle-container");b.innerHTML='<iframe id="readabilityKindleIframe" name="readabilityKindleIframe" scrolling="no" onload="readability.removeFrame()" style="width:500px; height: 490px; border: 0;"></iframe>';document.body.appendChild(b);var a='<form id="readabilityKindleForm" style="display: none;" target="readabilityKindleIframe" method="post" action="'+readability.kindleSrc+'">		                     <input type="hidden" name="bodyContent" id="bodyContent" value="'+readability.htmlspecialchars(document.getElementById("readability-content").innerHTML)+'" />						     <input type="hidden" name="pageUrl" id="pageUrl" value="'+readability.htmlspecialchars(window.location)+'" />						     <input type="hidden" name="pageTitle" id="pageUrl" value="'+readability.htmlspecialchars(document.title)+'" />                         </form>';document.body.innerHTML+=a;document.forms.readabilityKindleForm.submit()},removeFrame:function(){readability.iframeLoads++;if(readability.iframeLoads>3){var b=document.getElementById("email-container");if(null!==b){b.parentNode.removeChild(b)}var a=document.getElementById("kindle-container");if(null!==a){a.parentNode.removeChild(a)}readability.iframeLoads=0}},htmlspecialchars:function(a){if(typeof(a)=="string"){a=a.replace(/&/g,"&amp;");a=a.replace(/"/g,"&quot;");a=a.replace(/'/g,"&#039;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;")}return a}};readability.init();